# Снайпер бот

Бекенд-приложение бота для Telegram для автоматизации торговли на децентрализованной бирже Uniswap в сети Polygon. Учебный проект MetaLamp Node.js Education.

Написано на node.js с использованием typescript, Nest, viem, TypeORM и PostgreSQL.

Установить зависимости: `npm install`<br>
Создать базу в PostgreSql<br>
Переименовать `.env-default` в `.env` и задать настройки БД и бота<br>

Запустить приложение: `npm run dev`

## Настройки ##

```
APP_PORT=3000 // порт приложения
DATABASE_URL=""
BLOCKCHAIN="polygon" // используемая сеть

TELEGRAM_API_URL="https://api.telegram.org/bot"
TELEGRAM_TOKEN=""
TELEGRAM_USE_WEBHOOK=true // использовать веб хуки
TELEGRAM_USE_UPDATE=false // получать обновления через getUpdates
```

В *database.service.ts* `synchronize: true` - таблицы создадутся автоматически.

Веб-хуки принимаются по url `http://localhost:3000/bots/telegram`. В папке `tests/postman` есть коллекция запросов.

## Возможности ##
* Регистрация пользователя в боте `/start` (+ создание кошелька в сети Polygon)
* Добавление токенов для торговли `/addtoken адрес_токена`
* Просмотр балансов токенов `/balance`
* Удалить токен `/removetoken адрес_токена`
* Подписка на кошелек `/follow адрес_кошелька` или `/follow адрес_кошелька_1 адрес_кошелька_2 ... адрес_кошелька_5`
* Повторные сделки `/replicate buy/sell адрес_токена лимит_суммы_human_readable`
* Просмотр подписок `/subscriptions`
* Удалить кошелек из подписок `/unfollow адрес_кошелька`
* Автоматическое повторение сделок на Uniswap (реализовано через simulateContract)
* Оповещает в telegram об операциях и нехватке баланса
* Перевод токенов `/send адрес_токена сумма_human_readable адрес_кошелька`

## Тестирование ##

### Автоматические тесты ###
Реализованы тесты с моками и интеграционные для полной проверки работы api. Проверяется валидность входных данных, успешные и неуспешные результаты ответов, а также проблемы подключения к БД.

Запуск тестов: `npm test`

### Postman ###

В папке `tests/postman` есть коллекция запросов для тестирования вручную.